// STACK
var routes    = require('routes')
var h         = require('virtual-hyperscript-hook')(require('virtual-dom/h'))
var styling   = require('_styling')
// CUSTOM
var Header    = require('_header')
var pageHome  = require('_page_home')
var Footer    = require('_footer')

var ROUTER

// STANDARD INTERFACE ???
// module.exports = function (req, res, params) {
//     res.end('beep boop\n');
// };
// and then in the server.js I can do:
//
// router.addRoute('/whatever', require('./lib/someroute.js'));

// VS.

// state && state.route
// ??

// &&

// // e.g.
// ./SOURCE/node_modules/_router/index.js
// ./SOURCE/node_modules/_router/someroute.js
// ./SOURCE/node_modules/_router/...

// module.exports = function (msg) {
//     return function (req, res, params) {
//         res.end(msg + '\n');
//     };
// };
// and then in server.js:
//
// router.addRoute('/whatever', require('./lib/someroute.js')('beep boop'));

module.exports = function _router (state) {
  if (!ROUTER) {
    ROUTER        = routes()
    var hHeader   = Header(state)
    var hPageHome = pageHome(state)
    var hFooter   = Footer(state)


    ROUTER.addRoute('*', (function (s) { return function (state) {
    // ROUTER.addRoute('/', (function (s) { return function (state) {
      s = s ? s : styling(`
        .start {
          background-color  : ${state.theme.colors.white};
          display           : flex;
          flex-direction    : column;
        }
      `)
      return h('div', { className: s('.start') }, [
        hHeader(state),
        hPageHome(state),
        hFooter(state)
      ])
    }})())

  }

  return ROUTER
}
