// STACK
var h       = require('virtual-hyperscript-hook')(require('virtual-dom/h'))
var jss     = require('jss')
var css2jss = require('jss-cli/lib/cssToJss')

module.exports = HeaderComponent

function HeaderComponent (state) {
  // STYLING
  // @TODO: use: state.theme.colors
  var sheet  = jss.create().createStyleSheet(css2jss(`
    @font-face {
      font-family : "HelveticaNeue-UltraLight";
      src         : url(assets/HelveticaNeue-UltraLight.woff);
    }
    .header {
      align-items         : center;
      background-color    : ${state.theme.colors.white};
      display             : flex;
      justify-content     : center;
      min-width           : 1000px;
      padding             : 1em;
      position            : relative;
    }
    .logo {
      display             : flex;
    }
    .menubar {
      align-items         : center;
      background-color    : ${state.theme.colors.white};
      border-top-style    : dotted;
      border-top-width    : 0.25em;
      border-top-color    : ${state.theme.colors.red};
      border-bottom-style : dotted;
      border-bottom-width : 0.25em;
      border-bottom-color : ${state.theme.colors.red};
      display             : flex;
      flex-wrap           : nowrap;
      font-size           : 25px;
      height              : 6.5em;
      justify-content     : space-between;
      margin-top          : 0.1em;
      margin-right        : 20%;
      padding-left        : 4em;
      padding-right       : 4em;
    }
    .menuitem {
      background-color    : ${state.theme.colors.white};
      display             : flex;
      color               : ${state.theme.colors.black};
      font-family         : "HelveticaNeue-UltraLight";
      text-decoration     : none;
      padding             : 1.5em;
    }
    .submenuitem {
      background-color    : yellow;
      padding             : 10px;
    }
    .submenu {
      background-color    : lightgreen;
      font-size           : 25px;
      left                : 0px;
      margin-top          : 20px;
      position            : absolute;
    }
    .isVisible {
      display             : flex;
    }
    .isHidden {
      display             : none;
    }
  `),{ named: true, link: true }).attach()
  function s (name, modifier) {
    modifier = modifier ? '  ' + sheet.classes[modifier] : ''
    name     = sheet.classes[name]
    return name + modifier
  }
  // var color = sheet.getRule('.header').prop('background-color')
  // var color = sheet.getRule('.header').prop('background-color', 'green')

  return function Header (state) {
    function submenu (children) {
      if (!state.ui.submenu) { state.ui.submenu = {} }
      var attributes = {
        className   : s('.submenu', state.ui.submenu.products ? '.isVisible' : '.isHidden')
      }
      return h('div', attributes,
        children.map(function (entry) {
          return h('div', { className: s('.submenuitem') }, [
            h('a', { href: entry.link }, entry.name)
          ])
        })
      )
    }
    return (
      h('div', { className: s('.header') }, [
        h('div', { className: s('.menubar') }, [
          h('span', [
            h('a', {
              className: s('.menuitem'),
              href: '/#products',
              onmouseenter: function (event) {
                if (!state.ui.submenu.products) {
                  state.ui.submenu.products = true
                  state.action('#! open submenu', state)
                }
              },
              onmouseleave: function (event) {
                if (state.ui.submenu.products) {
                  state.ui.submenu.products = false
                  state.action('#! close submenu', state)
                }
              }
            }, 'Produkte'),
            submenu([{
              link  : '/#products/learning-experience',
              name  : 'Learning Experience'
            },{
              link  : '/#products/female-leadership',
              name  : 'Female Leadership'
            },{
              link  : '/#products/book',
              name  : 'Buch'
            }])
          ]),
          h('span', [
            h('a', {
              className: s('.menuitem'),
              href: '/#about'
            }, 'Ãœber uns')
          ]),
          h('span', [
            h('a', {
              className: s('.menuitem'),
              href: '/#contact'
            }, 'Kontakt')
          ])
        ]),
        h('a', { className: s('.logo'), href: '/'}, [
          h('img', { src: 'assets/redlab.svg', height: '200' })
        ])
      ])
    )
  }
}
